From a2319436c4d9398cc254be1a3a37b86716b3f176 Mon Sep 17 00:00:00 2001
From: Chirayu Desai <chirayudesai1@gmail.com>
Date: Tue, 7 Mar 2023 01:55:33 +0530
Subject: [PATCH] try policy

* https://developer.android.com/reference/android/os/Bundle#putShort(java.lang.String,%20short)
* "Inserts a short value into the mapping of this Bundle, replacing any existing value for the given key."
---
 .../components/policy/AppRestrictionsProvider.java        | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

diff --git a/components/policy/android/java/src/org/chromium/components/policy/AppRestrictionsProvider.java b/components/policy/android/java/src/org/chromium/components/policy/AppRestrictionsProvider.java
index 85cf94e4e6ec9..7a2b3775af0bd 100644
--- a/components/policy/android/java/src/org/chromium/components/policy/AppRestrictionsProvider.java
+++ b/components/policy/android/java/src/org/chromium/components/policy/AppRestrictionsProvider.java
@@ -24,12 +24,16 @@ public class AppRestrictionsProvider extends AbstractAppRestrictionsProvider {
      */
     public static Bundle getApplicationRestrictionsFromUserManager(
             UserManager userManager, String packageName) {
+        Bundle restrictions = new Bundle();
         try {
-            return userManager.getApplicationRestrictions(packageName);
+            restrictions = userManager.getApplicationRestrictions(packageName);
         } catch (SecurityException e) {
             // Android bug may throw SecurityException. See crbug.com/886814.
-            return new Bundle();
+            // Do nothing
         }
+        // https://chromeenterprise.google/policies/#BrowserSignin
+        restrictions.putShort("BrowserSignin", (short) 0);
+        return restrictions;
     }
 
     private final UserManager mUserManager;
-- 
2.39.2

